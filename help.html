<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Ayuda - Auto Par치metros</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #1f2937;
      line-height: 1.6;
    }
    
    .help-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    
    h1 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 28px;
    }
    
    .subtitle {
      color: #6b7280;
      margin-bottom: 30px;
      font-size: 16px;
    }
    
    h2 {
      color: #374151;
      margin-top: 30px;
      margin-bottom: 15px;
      font-size: 20px;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 8px;
    }
    
    h3 {
      color: #4b5563;
      margin-top: 20px;
      margin-bottom: 10px;
      font-size: 16px;
    }
    
    p {
      margin-bottom: 15px;
      color: #4b5563;
    }
    
    ul {
      margin-left: 20px;
      margin-bottom: 15px;
    }
    
    li {
      margin-bottom: 8px;
      color: #4b5563;
    }
    
    .config-option {
      background: #f9fafb;
      border-left: 4px solid #667eea;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 4px;
    }
    
    .config-option strong {
      color: #667eea;
      display: block;
      margin-bottom: 5px;
    }
    
    .note {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    
    .note strong {
      color: #92400e;
    }
    
    .credits {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 2px solid #e5e7eb;
      text-align: center;
      color: #6b7280;
    }
    
    .credits strong {
      color: #667eea;
      font-size: 18px;
    }
    
    .credits a {
      color: #667eea;
      text-decoration: none;
    }
    
    .credits a:hover {
      text-decoration: underline;
    }
    
    code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: #dc2626;
    }
    
    .btn-close {
      display: block;
      margin: 30px auto 0;
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
    }
    
    .btn-close:hover {
      background: #5568d3;
    }
  </style>
</head>
<body>
  <div class="help-container">
    <h1>游닄 Auto Par치metros - Gu칤a de Configuraci칩n</h1>
    <p class="subtitle">Aprende c칩mo configurar y utilizar la extensi칩n de Auto Par치metros para Tableau</p>
    
    <h2>쯈u칠 hace esta extensi칩n?</h2>
    <p>
      Auto Par치metros permite cargar autom치ticamente valores en los par치metros de Tableau bas치ndose en el usuario actual.
      La extensi칩n lee datos de una fuente de datos (normalmente un Hyper) y configura m칰ltiples par치metros simult치neamente.
    </p>
    
    <h2>Configuraci칩n Paso a Paso</h2>
    
    <div class="config-option">
      <strong>1. Worksheet (Hoja) de Datos</strong>
      <p>Selecciona la hoja de Tableau que contiene la fuente de datos con la informaci칩n de usuarios.</p>
      <p><em>Ejemplo:</em> Si tienes una hoja llamada "Usuarios Config", selecci칩nala aqu칤.</p>
    </div>
    
    <div class="config-option">
      <strong>2. Fuente de Datos de Usuarios</strong>
      <p>Una vez seleccionada la hoja, elige la fuente de datos espec칤fica (Hyper) que contiene los datos de usuarios.</p>
      <p><em>Ejemplo:</em> <code>HYPER_CONECTIVIDAD</code> o <code>usuarios.hyper</code></p>
    </div>
    
    <div class="config-option">
      <strong>3. Columna de Username</strong>
      <p>Selecciona la columna que identifica al usuario actual. Normalmente es el campo de email.</p>
      <p><em>Ejemplo:</em> <code>EMAIL</code> o <code>USERNAME</code></p>
    </div>
    
    <div class="config-option">
      <strong>4. Ocultar extensi칩n despu칠s de cargar</strong>
      <p>
        Si activas esta opci칩n, la extensi칩n se ocultar치 autom치ticamente una vez que los par치metros se carguen exitosamente.
        Esto mejora la experiencia del usuario final al no mostrar la interfaz de carga despu칠s de completarse.
      </p>
      <p><strong>Nota:</strong> En modo editor, siempre podr치s acceder a la configuraci칩n desde el men칰 de la extensi칩n.</p>
    </div>
    
    <div class="config-option">
      <strong>5. Mensaje de error personalizado</strong>
      <p>
        Define el mensaje que ver치n los usuarios cuando no se encuentren sus datos o no tengan un rol asignado.
        Puedes incluir URLs que se convertir치n autom치ticamente en enlaces clickeables.
      </p>
      <p><em>Ejemplo:</em> "No se encontr칩 tu usuario. Por favor contacta a soporte en https://miempresa.com/soporte"</p>
    </div>
    
    <div class="config-option">
      <strong>6. URL acortada (opcional)</strong>
      <p>
        Si tu mensaje de error incluye una URL larga, puedes usar un acortador de enlaces (como bit.ly o tinyurl.com)
        y colocar aqu칤 la URL corta. Esta URL se mostrar치 en el mensaje de error en lugar de la URL original.
      </p>
      <p><em>Ejemplo:</em> <code>https://bit.ly/soporte-tableau</code></p>
    </div>
    
    <h2>Mapeo de Par치metros</h2>
    <p>
      El mapeo conecta las columnas de tu fuente de datos con los par치metros de Tableau:
    </p>
    
    <div class="config-option">
      <strong>Columna de Datos</strong>
      <p>La columna en tu fuente de datos que contiene el valor (Ej: <code>ROL</code>, <code>REGION</code>)</p>
    </div>
    
    <div class="config-option">
      <strong>Par치metro de Tableau</strong>
      <p>El par치metro de Tableau que recibir치 el valor (Ej: <code>RolParametro</code>, <code>RegionParametro</code>)</p>
    </div>
    
    <div class="note">
      <strong>游눠 Consejo:</strong> Puedes agregar m칰ltiples mapeos para configurar varios par치metros a la vez.
      Usa el bot칩n "+ Agregar Mapeo" para a침adir m치s conexiones.
    </div>
    
    <h2>Importar/Exportar Configuraci칩n</h2>
    
    <h3>Importar desde CSV</h3>
    <p>
      Puedes importar m칰ltiples mapeos de una sola vez usando formato CSV:
    </p>
    <p><code>EMAIL,Usuario,ROL,RolParametro,REGION,RegionParametro</code></p>
    <p>El formato es: Columna1,Parametro1,Columna2,Parametro2,...</p>
    
    <h3>Exportar como CSV</h3>
    <p>
      Usa el bot칩n "游늶 Copiar Configuraci칩n como CSV" para copiar tu configuraci칩n actual al portapapeles.
      Esto es 칰til para respaldar o compartir tu configuraci칩n con otros dashboards.
    </p>
    
    <h2>Modo Editor vs Modo Visualizaci칩n</h2>
    <ul>
      <li><strong>Modo Editor:</strong> La extensi칩n muestra logs detallados y siempre permite acceder a la configuraci칩n</li>
      <li><strong>Modo Visualizaci칩n:</strong> La extensi칩n muestra solo mensajes esenciales al usuario final</li>
    </ul>
    
    <h2>Soluci칩n de Problemas</h2>
    
    <h3>La extensi칩n no carga mis par치metros</h3>
    <ul>
      <li>Verifica que la fuente de datos est칠 correctamente conectada en el worksheet seleccionado</li>
      <li>Confirma que los nombres de las columnas y par치metros sean exactos (distinguen may칰sculas/min칰sculas)</li>
      <li>Revisa los logs en modo editor para ver mensajes de error espec칤ficos</li>
    </ul>
    
    <h3>La extensi칩n no se oculta despu칠s de cargar</h3>
    <ul>
      <li>Verifica que la opci칩n "Ocultar extensi칩n despu칠s de cargar" est칠 marcada</li>
      <li>Aseg칰rate de que el usuario tenga un rol v치lido (no NULL o vac칤o)</li>
      <li>Abre la consola del navegador (F12) para ver los logs detallados</li>
    </ul>
    
    <h3>Mensaje "No se encontr칩 el Worksheet"</h3>
    <ul>
      <li>Verifica que el worksheet seleccionado a칰n exista en el dashboard</li>
      <li>Si renombraste el worksheet, actualiza la configuraci칩n</li>
    </ul>
    
    <div class="credits">
      <p><strong>Extensi칩n creada por</strong></p>
      <p>Andr칠s Canido</p>
      <p><a href="mailto:andres.canido@mercadolibre.com">andres.canido@mercadolibre.com</a></p>
      <p style="margin-top: 10px; font-size: 14px; color: #9ca3af;">
        춸 2025 - Auto Par치metros para Tableau
      </p>
    </div>
    
    <button class="btn-close" onclick="window.close()">Cerrar Ayuda</button>
  </div>
</body>
</html>
